# ============================================
# RAGböx Environment Variables
# Copy this file to .env.local and fill in values
# ============================================
# Generated by Sarah (QA) — EPIC-015 SA01, refreshed EPIC-017 SA06
# Last updated: 2026-02-25

# ===========================================
# Application
# ===========================================

NODE_ENV=development
NEXT_PUBLIC_APP_URL=http://localhost:3000

# ===========================================
# Database (PostgreSQL)
# ===========================================

DATABASE_URL=postgresql://user:password@localhost:5432/ragbox

# Admin DB URL (for migrations endpoint — can be same as DATABASE_URL)
# ADMIN_DATABASE_URL=postgresql://admin:password@localhost:5432/ragbox

# ===========================================
# Authentication (NextAuth.js)
# ===========================================

# Generate with: openssl rand -base64 32
NEXTAUTH_SECRET=your-nextauth-secret-here
NEXTAUTH_URL=http://localhost:3000

# Google OAuth
# Add BOTH redirect URIs in Google Cloud Console > APIs & Services > Credentials:
#   - http://localhost:3000/api/auth/callback/google  (local dev)
#   - https://YOUR-CLOUD-RUN-URL/api/auth/callback/google  (production)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Microsoft Azure AD (optional)
# AZURE_AD_CLIENT_ID=your-azure-client-id
# AZURE_AD_CLIENT_SECRET=your-azure-client-secret
# AZURE_AD_TENANT_ID=common

# ===========================================
# Go Backend
# ===========================================

# URL where the Go backend is running
GO_BACKEND_URL=http://localhost:8080
NEXT_PUBLIC_API_URL=http://localhost:8080

# Shared secret between Next.js and Go backend
INTERNAL_AUTH_SECRET=generate-a-shared-secret-here

# Go backend listen port (defaults to 8080)
# PORT=8080

# ===========================================
# LLM Provider Configuration
# ===========================================

# Development: openrouter | Production: vertex-llama
LLM_PROVIDER=openrouter

# OpenRouter (Development)
OPENROUTER_API_KEY=sk-or-v1-your-key-here
OPENROUTER_MODEL=meta-llama/llama-3.3-70b-instruct

# Vertex AI (Production — Sovereign Stack)
# VERTEX_PROJECT_ID=your-gcp-project
# VERTEX_REGION=us-central1
# VERTEX_LLAMA_ENDPOINT=your-endpoint
# VERTEX_AI_LOCATION=us-east4

# RAG generation model (Gemini)
# RAG_GENERATION_MODEL=gemini-2.0-flash-001
# GEMINI_LIVE_LOCATION=us-central1

# DeepSeek (optional alternative LLM)
# DEEPSEEK_ENDPOINT_URL=https://your-deepseek-endpoint
# DEEPSEEK_API_KEY=your-deepseek-key

# ===========================================
# Embedding Model
# ===========================================

# Development: openai | Production: local-bge
EMBEDDING_PROVIDER=openai
OPENAI_API_KEY=sk-your-openai-key

# Production (Local BGE-m3)
# EMBEDDING_PROVIDER=local-bge
# BGE_MODEL_PATH=/models/bge-m3

# Embedding cache TTL in seconds (Go backend)
# EMBEDDING_CACHE_TTL=3600

# ===========================================
# Vector Database (Qdrant)
# ===========================================

QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=

# ===========================================
# GCP / Google Cloud
# ===========================================

# GCP project ID (used by multiple services)
GCP_PROJECT_ID=your-gcp-project-id
GOOGLE_CLOUD_PROJECT=your-gcp-project-id
# GCP_PROJECT=your-gcp-project-id  (alias — deprecated)
GCP_LOCATION=us-east4

# Google Cloud Storage
GCS_BUCKET_NAME=ragbox-documents-prod

# Service account credentials (production uses workload identity)
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json

# ===========================================
# Firebase (Client-side Auth & Analytics)
# ===========================================

NEXT_PUBLIC_FIREBASE_API_KEY=your-firebase-api-key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your-firebase-project-id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your-project.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=123456789
NEXT_PUBLIC_FIREBASE_APP_ID=1:123456789:web:abcdef
NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID=G-XXXXXXXXXX

# ===========================================
# Redis / Cache
# ===========================================

REDIS_URL=redis://localhost:6379

# Query cache TTL in seconds (default: 900 = 15 minutes)
# QUERY_CACHE_TTL=900

# ===========================================
# Stripe (Billing)
# ===========================================

STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret

# Price IDs for subscription plans (EPIC-016 P01 canonical tiers)
STRIPE_PRICE_STARTER=price_your-starter-plan-id
STRIPE_PRICE_PROFESSIONAL=price_your-professional-plan-id
STRIPE_PRICE_ENTERPRISE=price_your-enterprise-plan-id
STRIPE_PRICE_SOVEREIGN=price_your-sovereign-plan-id
# STRIPE_PRICE_MERCURY=  (deprecated — use STRIPE_PRICE_PROFESSIONAL)

# Enable billing simulation endpoint (dev/test only — returns 404 when unset)
# ENABLE_BILLING_SIMULATION=true

# ===========================================
# Voice / Mercury Agent
# ===========================================

# Deepgram STT
DEEPGRAM_API_KEY=your-deepgram-key
# NEXT_PUBLIC_DEEPGRAM_MODEL=nova-2

# Inworld AI TTS (base64 API key — ACTIVE, powers Mercury voice synthesis)
# EPIC-017 S07 audit: INWORLD_API_KEY is actively used by /api/voice/synthesize routes.
# INWORLD_SCENE and INWORLD_CHARACTER do not exist in codebase — never needed.
# INWORLD_API_KEY=your-inworld-key

# AssemblyAI (alternative STT)
# ASSEMBLY_AI_API_KEY=your-assemblyai-key

# Voice server config
NEXT_PUBLIC_VOICE_WS_URL=ws://localhost:3003/agent/ws
# VOICE_SERVER_PORT=3003
# VOICE_SERVER_HOST=0.0.0.0
# ALLOWED_ORIGINS=*

# ===========================================
# Gmail (System Emails — OTP / Magic Links)
# ===========================================

# Gmail API credentials (optional — falls back to console log in dev)
# GMAIL_CLIENT_ID=your-gmail-client-id
# GMAIL_CLIENT_SECRET=your-gmail-client-secret
# GMAIL_REFRESH_TOKEN=your-gmail-refresh-token
# GMAIL_FROM=RAGbox <noreply@ragbox.co>

# Gmail OAuth redirect (for agent email connection)
# GMAIL_OAUTH_REDIRECT_BASE=http://localhost:3000

# Gmail Pub/Sub push token
# GMAIL_PUBSUB_TOKEN=your-pubsub-verification-token

# ===========================================
# WhatsApp Integration
# ===========================================

# Provider: vonage (sandbox/demo) | meta (production)
WHATSAPP_PROVIDER=vonage

# Default user ID to route inbound WhatsApp messages to
WHATSAPP_DEFAULT_USER_ID=

# WhatsApp verification token for webhook setup
# WHATSAPP_VERIFY_TOKEN=mercury-ragbox-verify

# Vonage Messages API
VONAGE_API_KEY=your-vonage-key
VONAGE_API_SECRET=your-vonage-secret
VONAGE_APPLICATION_ID=your-vonage-app-id
VONAGE_PRIVATE_KEY_PATH=./vonage-private.key
VONAGE_WHATSAPP_NUMBER=14157386102
VONAGE_SIGNATURE_SECRET=your-vonage-signature-secret

# Vonage SMS (optional — defaults to WhatsApp number)
# VONAGE_SMS_FROM_NUMBER=14157386102

# Meta Cloud API (production WhatsApp)
# META_WHATSAPP_TOKEN=your-meta-token
# META_WHATSAPP_PHONE_ID=your-phone-id
# META_WHATSAPP_VERIFY_TOKEN=your-verify-token
# META_APP_SECRET=your-app-secret

# ===========================================
# Roam Integration (Compliance)
# ===========================================

# ROAM_API_URL=https://api.ro.am/v1
# ROAM_API_KEY=your-roam-api-key
# ROAM_WEBHOOK_SECRET=your-roam-webhook-secret
# ROAM_DEFAULT_USER_ID=  (falls back to WHATSAPP_DEFAULT_USER_ID)

# ===========================================
# Monitoring / Observability
# ===========================================

SENTRY_DSN=https://your-sentry-dsn
NEXT_PUBLIC_SENTRY_DSN=https://your-public-sentry-dsn

# Backend URL (used by /api/usage — may differ from GO_BACKEND_URL in Cloud Run)
# BACKEND_URL=http://localhost:8080

# ===========================================
# KMS (Key Management — Encryption at Rest)
# ===========================================

# Set to 'stub' for local dev (skips real KMS calls)
# KMS_MODE=stub

# ===========================================
# Cron Jobs
# ===========================================

# Secret for authenticating cron job requests
# CRON_SECRET=your-cron-secret

# ===========================================
# Feature Flags
# ===========================================

# Enable Mercury agent UI
# NEXT_PUBLIC_MERCURY_ENABLED=true

# RAG quality tuning
# CONFIDENCE_FLOOR=0.30
# SELFRAG_SKIP_THRESHOLD=0.5
# SELF_RAG_MAX_ITERATIONS=1

# ===========================================
# Test-Only Variables (not needed for production)
# ===========================================

# Gate expensive test suites
# QUALITY_TESTS=1
# TENANT_TESTS=1

# Smoke test config
# PRODUCTION=true
# BACKEND_URL=https://ragbox-backend-xxx.us-east4.run.app
# APP_URL=https://app.ragbox.co
# VOICE_URL=https://mercury-voice-xxx.us-east4.run.app
# SMOKE_TEST_TOKEN=your-test-jwt
# API_URL=http://localhost:3000
# WS_URL=ws://localhost:3000
